# 50. Что знаете об коллекциях типа List как добавляется элемент\расширяется коллекция?

`List` — это интерфейс, представляющий упорядоченную коллекцию, которая позволяет хранить дубликаты элементов. Основные реализации `List` в Java — это `ArrayList` и `LinkedList`. Давайте рассмотрим, как добавляются элементы и как расширяются эти коллекции.

---

### **1. Добавление элемента в `List`**

#### a) **Метод `add(E e)`**
- Добавляет элемент в конец списка.
- Время выполнения:
  - `ArrayList`: **O(1)** (амортизированное время), если не требуется увеличение размера массива.
  - `LinkedList`: **O(1)**.

#### Пример:
```java
List<String> list = new ArrayList<>();
list.add("Java"); // Добавляем элемент в конец списка
list.add("Python");
System.out.println(list); // [Java, Python]
```

#### b) **Метод `add(int index, E element)`**
- Добавляет элемент на указанную позицию.
- Время выполнения:
  - `ArrayList`: **O(n)**, так как требуется сдвиг элементов.
  - `LinkedList`: **O(1)**, если индекс близок к началу или концу списка.

#### Пример:
```java
list.add(1, "C++"); // Добавляем элемент на позицию 1
System.out.println(list); // [Java, C++, Python]
```

---

### **2. Расширение коллекции**

#### a) **`ArrayList`**
- Внутренне `ArrayList` использует массив для хранения элементов.
- При добавлении элемента, если массив заполнен, `ArrayList` создает новый массив большего размера и копирует в него все элементы.

##### Как работает расширение:
1. Начальная емкость (capacity) по умолчанию — **10**.
2. При добавлении элемента, если массив заполнен, `ArrayList` увеличивает свой размер на **50%** (новый размер = старый размер * 1.5).
3. Элементы копируются в новый массив.

##### Пример:
```java
List<Integer> arrayList = new ArrayList<>();
for (int i = 0; i < 15; i++) {
    arrayList.add(i); // При добавлении 11-го элемента массив расширяется
}
System.out.println(arrayList.size()); // 15
```

#### b) **`LinkedList`**
- Внутренне `LinkedList` использует двусвязный список для хранения элементов.
- Каждый элемент (узел) содержит ссылки на предыдущий и следующий элементы.
- Расширение происходит динамически, так как каждый новый элемент просто добавляется в конец списка.

##### Как работает расширение:
1. При добавлении элемента создается новый узел.
2. Узел связывается с последним элементом списка.
3. Время добавления — **O(1)**.

##### Пример:
```java
List<Integer> linkedList = new LinkedList<>();
for (int i = 0; i < 15; i++) {
    linkedList.add(i); // Новый элемент добавляется в конец списка
}
System.out.println(linkedList.size()); // 15
```

---

### **3. Внутренняя структура**

#### a) **`ArrayList`**
- Использует массив (`Object[]`).
- Начальная емкость может быть задана через конструктор:
  ```java
  List<Integer> list = new ArrayList<>(20); // Начальная емкость 20
  ```
- При расширении создается новый массив, и элементы копируются в него.

#### b) **`LinkedList`**
- Использует двусвязный список.
- Каждый узел (`Node`) содержит:
  - Данные (элемент).
  - Ссылку на предыдущий узел.
  - Ссылку на следующий узел.

---

### **4. Сравнение `ArrayList` и `LinkedList`**

| Характеристика          | `ArrayList`                      | `LinkedList`                     |
|-------------------------|----------------------------------|----------------------------------|
| **Внутренняя структура**| Массив (`Object[]`)              | Двусвязный список                |
| **Добавление в конец**  | O(1) (амортизированное время)    | O(1)                            |
| **Добавление в середину**| O(n)                            | O(1) (если известен узел)        |
| **Расширение**          | Увеличивает размер на 50%        | Динамическое добавление узлов    |
| **Память**              | Меньше (только данные)           | Больше (данные + ссылки)         |
| **Доступ по индексу**   | O(1)                            | O(n)                            |

---

### **5. Примеры**

#### Пример 1: Добавление элементов в `ArrayList`
```java
List<String> arrayList = new ArrayList<>();
arrayList.add("Java");
arrayList.add("Python");
arrayList.add(1, "C++"); // Добавляем элемент на позицию 1
System.out.println(arrayList); // [Java, C++, Python]
```

#### Пример 2: Добавление элементов в `LinkedList`
```java
List<String> linkedList = new LinkedList<>();
linkedList.add("Java");
linkedList.add("Python");
linkedList.add(1, "C++"); // Добавляем элемент на позицию 1
System.out.println(linkedList); // [Java, C++, Python]
```

---

### **6. Когда использовать `ArrayList` и `LinkedList`?**

#### **`ArrayList`:**
- Когда требуется частый доступ по индексу.
- Когда добавление элементов происходит в основном в конец списка.
- Когда важна экономия памяти.

#### **`LinkedList`:**
- Когда требуется частое добавление/удаление элементов в середине списка.
- Когда важна производительность при добавлении/удалении элементов.

---

### **Итог**

- **`ArrayList`** использует массив и расширяется на 50% при заполнении.
- **`LinkedList`** использует двусвязный список и динамически добавляет узлы.
- Добавление элемента в конец списка в обоих случаях занимает **O(1)**.
- Добавление элемента в середину списка в `ArrayList` занимает **O(n)**, а в `LinkedList` — **O(1)**.

Выбор между `ArrayList` и `LinkedList` зависит от конкретной задачи и требований к производительности.
