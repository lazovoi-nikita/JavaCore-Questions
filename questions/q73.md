# 73. Отличия flatMap от Map?

`map` и `flatMap` — это промежуточные операции в Stream API, которые используются для преобразования элементов потока. Однако они работают по-разному и применяются в разных сценариях.

---

### **1. Метод `map()`**

#### **Описание:**
- **`map(Function<T, R> mapper)`:** Преобразует каждый элемент потока с помощью заданной функции.
- **Принимает:** Функцию (`Function<T, R>`), которая принимает элемент типа `T` и возвращает элемент типа `R`.
- **Возвращает:** Новый `Stream<R>`, где каждый элемент преобразован.

#### **Пример:**
```java
List<String> languages = Arrays.asList("Java", "Python", "C++");

List<Integer> lengths = languages.stream()
    .map(String::length) // Преобразуем каждую строку в ее длину
    .collect(Collectors.toList());

System.out.println(lengths); // [4, 6, 3]
```

---

### **2. Метод `flatMap()`**

#### **Описание:**
- **`flatMap(Function<T, Stream<R>> mapper)`:** Преобразует каждый элемент потока в поток (`Stream<R>`), а затем объединяет все потоки в один.
- **Принимает:** Функцию (`Function<T, Stream<R>>`), которая принимает элемент типа `T` и возвращает `Stream<R>`.
- **Возвращает:** Новый `Stream<R>`, объединяющий все потоки.

#### **Пример:**
```java
List<List<String>> lists = Arrays.asList(
    Arrays.asList("Java", "Python"),
    Arrays.asList("C++", "JavaScript"),
    Arrays.asList("Ruby", "Go")
);

List<String> flattenedList = lists.stream()
    .flatMap(List::stream) // Преобразуем каждый список в поток и объединяем
    .collect(Collectors.toList());

System.out.println(flattenedList); // [Java, Python, C++, JavaScript, Ruby, Go]
```

---

### **3. Основные отличия**

| Характеристика          | `map()`                              | `flatMap()`                          |
|-------------------------|--------------------------------------|--------------------------------------|
| **Тип возвращаемого значения** | `Stream<R>` (один элемент преобразуется в один элемент) | `Stream<R>` (один элемент преобразуется в поток, который затем объединяется) |
| **Применение**          | Преобразование элементов             | Преобразование и "уплощение" (объединение потоков) |
| **Пример использования**| Преобразование строк в их длины      | Преобразование списка списков в один список |

---

### **4. Примеры для понимания**

#### a) **Пример с `map()`**
```java
List<String> languages = Arrays.asList("Java", "Python", "C++");

List<String[]> result = languages.stream()
    .map(s -> s.split("")) // Преобразуем каждую строку в массив символов
    .collect(Collectors.toList());

System.out.println(result); // [[J, a, v, a], [P, y, t, h, o, n], [C, +, +]]
```

#### b) **Пример с `flatMap()`**
```java
List<String> languages = Arrays.asList("Java", "Python", "C++");

List<String> result = languages.stream()
    .map(s -> s.split("")) // Преобразуем каждую строку в массив символов
    .flatMap(Arrays::stream) // Преобразуем каждый массив в поток и объединяем
    .collect(Collectors.toList());

System.out.println(result); // [J, a, v, a, P, y, t, h, o, n, C, +, +]
```

---

### **5. Когда использовать `map` и `flatMap`?**

- **`map()`:** Используйте, когда нужно преобразовать каждый элемент потока в другой элемент (например, строку в ее длину).
- **`flatMap()`:** Используйте, когда нужно преобразовать каждый элемент в поток и объединить все потоки в один (например, список списков в один список).

---

### **6. Итог**

- **`map()`:** Преобразует каждый элемент потока в другой элемент.
- **`flatMap()`:** Преобразует каждый элемент в поток и объединяет все потоки в один.

Выбор между `map` и `flatMap` зависит от задачи. Если нужно просто преобразовать элементы, используйте `map`. Если нужно "уплощить" структуру (например, список списков в один список), используйте `flatMap`.
